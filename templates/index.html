<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curator</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü™ô</text></svg>">
    <link rel="stylesheet" href="/static/css/base.css?v=1767725875">
    <link rel="stylesheet" href="/static/css/themes.css?v=1767725875">
    <link rel="stylesheet" href="/static/css/layout.css?v=1767725875">
    <link rel="stylesheet" href="/static/css/components.css?v=1767725875">
    <link rel="stylesheet" href="/static/css/pages.css?v=1767725875">
    <script type="module" src="/static/js/main.js?v=1767725875"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-logout">
                <div>
                    <h1>ü™ô Curator</h1>
                    <p>Search, download, and organize your periodicals</p>
                </div>
                <button class="logout-btn" onclick="logout()">üö™ Logout</button>
            </div>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showTab('library', event)">üìö Library</button>
            <button class="nav-btn" onclick="showTab('tracking', event)">üìå Track Periodicals</button>
            <button class="nav-btn" onclick="showTab('tasks', event)">‚öôÔ∏è Tasks</button>
            <button class="nav-btn" onclick="showTab('settings', event)">üîß Settings</button>
        </nav>

        <!-- Library Tab -->
        <div id="library-tab" class="tab active">
            <div class="library-container">
                <h2>Your PDF Library</h2>
                <div class="library-header flex justify-between items-center gap-30 mb-40 flex-wrap">
                    <div class="flex gap-10 flex-wrap">
                        <button onclick="openImportModal()" class="btn-primary import-button-group">
                            üìÅ Import Downloads Folder
                        </button>
                        <button onclick="importFromOrganizeDir()" class="btn-primary import-button-group">
                            üìÅ Import Data Folder
                        </button>
                    </div>
                    <div class="library-controls flex gap-15">
                        <div class="sort-buttons">
                            <button class="sort-btn active" data-lib-sort="title" onclick="setLibrarySortField('title')">Title</button>
                            <button class="sort-btn" data-lib-sort="publisher" onclick="setLibrarySortField('publisher')">Publisher</button>
                            <button class="sort-btn" data-lib-sort="issue_date" onclick="setLibrarySortField('issue_date')">Issue Date</button>
                        </div>
                        <button id="library-sort-toggle" class="sort-toggle-btn" onclick="toggleLibrarySortOrder()" title="Toggle ascending/descending">
                            ‚Üë
                        </button>
                    </div>
                </div>
                <div id="import-status" class="hidden import-status bg-success"></div>
                <div id="periodicals-grid" class="periodical-grid"></div>
            </div>
        </div>

        <!-- Periodical Tracking Tab -->
        <div id="tracking-tab" class="tab">
            <div class="tracking-container">
                <div class="tracked-periodicals">
                    <div class="tracked-header">
                        <h2>Tracked Periodicals</h2>
                        <button onclick="openTrackNewPeriodicalModal()" class="btn-primary">üìå Track New Periodical</button>
                        <div class="sort-controls">
                            <div class="sort-buttons">
                                <button class="sort-btn active" data-sort="title" onclick="setSortField('title')">Title</button>
                                <button class="sort-btn" data-sort="publisher" onclick="setSortField('publisher')">Publisher</button>
                                <button class="sort-btn" data-sort="tracking_mode" onclick="setSortField('tracking_mode')">Tracking</button>
                            </div>
                            <button id="sort-toggle" class="sort-toggle-btn" onclick="toggleSortOrder()" title="Toggle ascending/descending">
                                ‚Üë
                            </button>
                        </div>
                    </div>
                    <div id="tracked-list"></div>
                </div>
            </div>
        </div>

        <!-- Tasks Tab -->
        <div id="tasks-tab" class="tab">
            <div class="tasks-container">
                <!-- Scheduled Tasks Section -->
                <div class="scheduled-tasks-section mb-40">
                    <h2>‚öôÔ∏è Scheduled Tasks</h2>
                    <p>View automated tasks and their last execution times. You can manually trigger tasks as needed.</p>
                    <div id="tasks-status" class="hidden"></div>
                    <div id="scheduled-tasks-list" class="grid gap-15 mt-20">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Download Queue Section -->
                <div class="download-queue-section">
                    <h2>‚¨áÔ∏è Download Queue</h2>
                <p>Monitor and manage your periodical downloads. See what's downloading, pending, completed, or failed. Auto-refreshes every 10 seconds.</p>
                <div id="downloads-status" class="hidden"></div>

                <div class="queue-stats flex gap-20 mb-30 p-15 bg-surface-variant rounded-lg flex-wrap" id="queue-stats">
                    <!-- Will be populated by JavaScript -->
                </div>

                <div id="queue-empty" class="hidden queue-empty-state">
                    <p>No downloads in queue</p>
                    <p class="text-base mt-10">üí° Tip: Use "Track Periodicals" tab ‚Üí Find Issues ‚Üí Download button to submit downloads for tracking</p>
                </div>

                <div id="queue-table-container" class="hidden">
                    <table class="queue-table w-full border-collapse mt-20">
                        <tbody id="queue-body">
                            <!-- Will be populated by JavaScript with grouped periodical rows -->
                        </tbody>
                    </table>
                </div>
                </div>

                <!-- Failed Downloads Section -->
                <div class="download-queue-section mt-40">
                    <h2>‚ö†Ô∏è Failed Downloads</h2>
                    <p>View and manage downloads that have failed, including files marked as bad (3+ failures).</p>
                    <div id="failed-downloads-container">
                        <!-- Will be populated by JavaScript -->
                        <p style="text-align: center; color: var(--text-secondary); padding: 40px;">Loading failed downloads...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="tab">
            <div class="settings-container">
                <div class="flex justify-between items-center mb-20">
                    <h2>Configuration Settings</h2>
                    <button onclick="restartApplication()" class="btn-danger">üîÑ Restart Application</button>
                </div>

                <!-- Settings Navigation Shortcuts -->
                <div class="settings-nav mb-30">
                    <button class="settings-nav-btn" onclick="scrollToSection('search-providers-section')">üîç Search Providers</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('download-client-section')">‚¨áÔ∏è Download Client</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('storage-section')">üíæ Storage</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('matching-section')">üéØ Matching</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('logging-section')">üìù Logging</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('theme-section')">üé® Theme</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('import-section')">üìÅ Import</button>
                    <button class="settings-nav-btn" onclick="scrollToSection('user-account-section')">üë§ Account</button>
                </div>

                <div id="settings-status" class="hidden"></div>

                <!-- Search Providers -->
                <div id="search-providers-section" class="settings-section">
                    <h3>Search Providers</h3>
                    <p class="text-base text-muted mb-15">For finding and downloading periodical issues (Newsnab, RSS, etc.)</p>
                    <div id="search-providers-list"></div>
                    <button onclick="addSearchProvider()" class="save-btn">+ Add Search Provider</button>
                    <div id="search-providers-message" class="hidden"></div>
                </div>

                <!-- Download Client Settings -->
                <div id="download-client-section" class="settings-section">
                    <h3>Download Client</h3>
                    <div class="settings-field">
                        <label for="download-client-type">Type:</label>
                        <select id="download-client-type">
                            <option value="sabnzbd">SABnzbd</option>
                            <option value="nzbget">NZBGet</option>
                        </select>
                    </div>
                    <div class="settings-field">
                        <label for="download-client-name">Name:</label>
                        <input type="text" id="download-client-name" placeholder="e.g., SABnzbd">
                    </div>
                    <div class="settings-field">
                        <label for="download-client-url">API URL:</label>
                        <input type="text" id="download-client-url" placeholder="http://192.168.1.112:9080">
                    </div>
                    <div class="settings-field">
                        <label for="download-client-apikey">API Key:</label>
                        <input type="password" id="download-client-apikey" placeholder="Enter your API key">
                    </div>
                    <button onclick="saveDownloadClientSettings()" class="save-btn">Save Download Client</button>
                    <div id="download-client-message" class="hidden"></div>
                </div>

                <!-- Storage Settings -->
                <div id="storage-section" class="settings-section">
                    <h3>Storage Settings</h3>
                    <div class="settings-field">
                        <label for="storage-db-path">Database Path:</label>
                        <input type="text" id="storage-db-path" placeholder="./data/periodicals.db">
                    </div>
                    <div class="settings-field">
                        <label for="storage-download-dir">Download Directory:</label>
                        <input type="text" id="storage-download-dir" placeholder="./downloads">
                    </div>
                    <div class="settings-field">
                        <label for="storage-organize-dir">Organize Directory:</label>
                        <input type="text" id="storage-organize-dir" placeholder="./periodicals">
                    </div>
                    <div class="settings-field">
                        <label for="storage-cache-dir">Cache Directory:</label>
                        <input type="text" id="storage-cache-dir" placeholder="./cache">
                    </div>
                    <button onclick="saveStorageSettings()" class="save-btn">Save Storage Settings</button>
                    <div id="storage-message" class="hidden"></div>
                </div>

                <!-- Matching Settings -->
                <div id="matching-section" class="settings-section">
                    <h3>Matching Settings</h3>
                    <div class="settings-field">
                        <label for="matching-fuzzy-threshold">Fuzzy Match Threshold (%):</label>
                        <input type="number" id="matching-fuzzy-threshold" placeholder="80" min="0" max="100">
                    </div>
                    <button onclick="saveMatchingSettings()" class="save-btn">Save Matching Settings</button>
                    <div id="matching-message" class="hidden"></div>
                </div>

                <!-- Logging Settings -->
                <div id="logging-section" class="settings-section">
                    <h3>Logging Settings</h3>
                    <div class="settings-field">
                        <label for="logging-level">Log Level:</label>
                        <select id="logging-level">
                            <option value="DEBUG">DEBUG</option>
                            <option value="INFO">INFO</option>
                            <option value="WARNING">WARNING</option>
                            <option value="ERROR">ERROR</option>
                        </select>
                    </div>
                    <div class="settings-field">
                        <label for="logging-file">Log File:</label>
                        <input type="text" id="logging-file" placeholder="./logs/periodical_manager.log">
                    </div>
                    <button onclick="saveLoggingSettings()" class="save-btn">Save Logging Settings</button>
                    <div id="logging-message" class="hidden"></div>
                </div>

                <!-- Theme Settings -->
                <div id="theme-section" class="settings-section">
                    <h3>Theme Settings</h3>
                    <div class="settings-field">
                        <label for="theme-mode">Color Mode:</label>
                        <select id="theme-mode">
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                        </select>
                    </div>
                    <button onclick="saveThemeSettings()" class="save-btn">Save Theme Settings</button>
                    <div id="theme-message" class="hidden"></div>
                </div>

                <!-- Import & Organization Settings -->
                <div id="import-section" class="settings-section">
                    <h3>Import & Organization</h3>
                    <div class="settings-field">
                        <label for="import-organize-pattern">File Organization Pattern:</label>
                        <input type="text" id="import-organize-pattern" placeholder="data/{category}/{title}/{year}/" class="w-full mt-8">
                        <p class="text-sm text-hint mt-8">Available tags: {category}, {title}, {year}, {month}, {day}. Leave empty to disable organization.</p>
                    </div>
                    <p class="text-base text-muted mt-10">Nested folder scanning in Downloads is always enabled.</p>
                    <button onclick="saveImportSettings()" class="save-btn">Save Import Settings</button>
                    <div id="import-message" class="hidden"></div>
                </div>

                <!-- User Account Settings -->
                <div id="user-account-section" class="settings-section">
                    <h3>User Account</h3>
                    <p class="text-base text-muted mb-15">Update your login credentials</p>
                    <div class="settings-field">
                        <label for="account-username">Username:</label>
                        <input type="text" id="account-username" placeholder="Loading...">
                    </div>
                    <div class="settings-field">
                        <label for="account-current-password">Current Password:</label>
                        <input type="password" id="account-current-password" placeholder="Enter current password to make changes">
                    </div>
                    <div class="settings-field">
                        <label for="account-new-password">New Password:</label>
                        <input type="password" id="account-new-password" placeholder="Leave blank to keep current password">
                    </div>
                    <div class="settings-field">
                        <label for="account-confirm-password">Confirm New Password:</label>
                        <input type="password" id="account-confirm-password" placeholder="Confirm new password">
                    </div>
                    <button onclick="saveAccountSettings()" class="save-btn">Save Account Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- PDF Viewer Modal -->
    <div id="pdf-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closePDFViewer()">&times;</span>
            <div id="pdf-viewer"></div>
        </div>
    </div>

    <!-- Add Provider Modal -->
    <div id="add-provider-modal" class="modal hidden">
        <div class="modal-content max-w-500">
            <span class="close" onclick="closeAddProviderModal()">&times;</span>
            <h3>Add New Search Provider</h3>
            <form id="add-provider-form" class="p-20">
                <div class="settings-field">
                    <label for="new-provider-type">Provider Type:</label>
                    <select id="new-provider-type" required>
                        <option value="newsnab">Newsnab</option>
                        <option value="rss">RSS</option>
                        <option value="torznab">Torznab</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="settings-field">
                    <label for="new-provider-name">Name:</label>
                    <input type="text" id="new-provider-name" placeholder="e.g., My Newsnab" required>
                </div>
                <div class="settings-field">
                    <label for="new-provider-url">API URL:</label>
                    <input type="text" id="new-provider-url" placeholder="http://example.com/api" required>
                </div>
                <div class="settings-field">
                    <label for="new-provider-key">API Key:</label>
                    <input type="password" id="new-provider-key" placeholder="Enter API key">
                </div>
                <div class="settings-field">
                    <label for="new-provider-categories">Categories <span style="font-size: 11px; color: var(--text-secondary);">(Newsnab only, e.g., 7000,7010,7030)</span>:</label>
                    <input type="text" id="new-provider-categories" placeholder="7000,7010,7020,7030">
                </div>
                <div class="settings-field">
                    <label>
                        <input type="checkbox" id="new-provider-enabled" checked>
                        <span>Enabled</span>
                    </label>
                </div>
                <div class="flex gap-10 mt-20">
                    <button type="submit" class="save-btn flex-1">Add Provider</button>
                    <button type="button" class="save-btn btn-cancel flex-1" onclick="closeAddProviderModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Tracking Details Modal -->
    <div id="edit-tracking-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeEditTrackingModal()">&times;</span>
            <h2>Edit Tracking Details</h2>
            
            <div class="settings-field">
                <label>Periodical Title:</label>
                <input type="hidden" id="edit-tracking-id">
                <input type="text" id="edit-tracking-title" placeholder="Enter title">
            </div>
            
            <div class="settings-field">
                <label>Publisher:</label>
                <div class="flex gap-10">
                    <input type="text" id="edit-tracking-publisher" placeholder="Enter publisher" class="flex-1">
                    <button onclick="searchPublisherMetadata()" class="save-btn">Search Metadata</button>
                </div>
            </div>
            
            <div class="settings-field">
                <label>ISSN:</label>
                <input type="text" id="edit-tracking-issn" placeholder="Enter ISSN">
            </div>
            
            <div class="settings-field">
                <label>Tracking Mode:</label>
                <select id="edit-tracking-mode" class="w-full">
                    <option value="all">Track All Issues - Download all past and future issues</option>
                    <option value="new">Track New Issues - Only download issues published after today</option>
                    <option value="none">Track Nothing - Monitor but don't auto-download</option>
                </select>
            </div>
            
            <div class="settings-field">
                <label>
                    <input type="checkbox" id="edit-delete-from-client">
                    Delete from download client after completion or failure
                </label>
                <p class="text-sm text-hint mt-8">Automatically removes completed/failed downloads from your download client history</p>
            </div>

            <div class="settings-field">
                <label for="edit-tracking-org-pattern">File Organization Pattern:</label>
                <input type="text" id="edit-tracking-org-pattern" placeholder="Leave empty to use global default" class="w-full">
                <p class="text-sm text-hint mt-8">Available tags: {category}, {title}, {year}, {month}, {day}. Example: data/{category}/{title}/{year}/</p>
            </div>

            <div class="flex gap-10 mt-20">
                <button onclick="saveEditedTracking()" class="save-btn btn-save flex-1">Save Changes</button>
                <button onclick="closeEditTrackingModal()" class="save-btn btn-cancel flex-1">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Search Issues Modal -->
    <div id="search-issues-modal" class="modal hidden">
        <div class="modal-content max-w-800">
            <span class="close" onclick="closeSearchIssuesModal()">&times;</span>
            <div id="search-issues-content"></div>
            <div class="mt-20">
                <button onclick="closeSearchIssuesModal()" class="save-btn w-full">Close</button>
            </div>
        </div>
    </div>

    <!-- Import Options Modal -->
    <div id="import-options-modal" class="modal hidden">
        <div class="modal-content max-w-600">
            <span class="close" onclick="closeImportModal()">&times;</span>
            <h3>Import Options</h3>
            
            <div class="settings-field" style="margin-top: 20px; margin-bottom: 20px;">
                <label>
                    <input type="checkbox" id="import-auto-track" checked>
                    Create tracking record for imported periodicals
                </label>
            </div>
            
            <div class="settings-field">
                <label for="import-tracking-mode">Tracking Mode:</label>
                <select id="import-tracking-mode" class="w-full">
                    <option value="all">‚¨áÔ∏è Auto-download All Issues</option>
                    <option value="new">‚¨áÔ∏è Auto-download New Issues Only</option>
                    <option value="watch">üëÅÔ∏è Watch Only (no auto-download)</option>
                </select>
                <p class="text-sm text-hint mt-8">Choose how to track this periodical for future releases</p>
            </div>
            
            <div class="settings-field">
                <label for="import-category">Category:</label>
                <select id="import-category" class="w-full">
                    <option value="auto">Auto-detect from title</option>
                    <option value="Magazines">Magazines</option>
                    <option value="Comics">Comics</option>
                    <option value="Articles">Articles</option>
                    <option value="News">News</option>
                </select>
            </div>
            
            <div class="settings-field">
                <label for="import-modal-organize-pattern">File Organization Pattern:</label>
                <input type="text" id="import-modal-organize-pattern" placeholder="Leave empty to use global default" class="w-full">
                <p class="text-sm text-hint mt-8">Available tags: {category}, {title}, {year}, {month}, {day}. Example: data/{category}/{title}/{year}/</p>
            </div>
            
            <div class="flex gap-10 mt-20">
                <button onclick="startImportWithOptions()" class="save-btn btn-save flex-1">Import</button>
                <button onclick="closeImportModal()" class="save-btn btn-cancel flex-1">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Track New Periodical Modal -->
    <div id="track-new-periodical-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeTrackNewPeriodicalModal()">&times;</span>
            <h2>Track New Periodical</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Search for a periodical to track</p>

            <div id="tracking-status" class="hidden"></div>

            <!-- Step 1: Search -->
            <div class="tracking-step">
                <h3>Step 1: Find Periodical</h3>
                <div class="tracking-search">
                    <input type="text" id="tracking-search-query" placeholder="Enter periodical title..."
                        onkeyup="event.key === 'Enter' && searchPeriodicalMetadata()">
                    <button onclick="searchPeriodicalMetadata()">Search</button>
                </div>
                <div id="tracking-search-loading" class="hidden">Searching...</div>
                <div id="tracking-search-result" class="tracking-result hidden">
                    <div id="periodical-info-card"></div>
                </div>
                <div id="tracking-search-error" class="error hidden"></div>
            </div>

            <!-- Step 2: Configure Tracking -->
            <div class="tracking-step hidden" id="save-step">
                <h3>Step 2: Configure Tracking</h3>
                <div id="save-info"></div>
                <div class="save-controls">
                    <div class="tracking-mode-options">
                        <label class="radio-label">
                            <input type="radio" name="tracking-mode" value="all" checked onchange="updateTrackingMode()">
                            <span><strong>Track All Issues</strong> - Download all past and future issues</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="tracking-mode" value="new" onchange="updateTrackingMode()">
                            <span><strong>Track New Issues</strong> - Only download issues published after today</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="tracking-mode" value="none" onchange="updateTrackingMode()">
                            <span><strong>Track Nothing</strong> - Monitor but don't auto-download</span>
                        </label>
                    </div>
                    <div class="flex gap-10 mt-20">
                        <button class="btn-primary flex-1" onclick="saveTrackingPreferences()">Save & Start Tracking</button>
                        <button class="btn-secondary flex-1" onclick="closeTrackNewPeriodicalModal()">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Periodical Modal - Outside Container -->
    <div id="delete-modal" class="modal hidden">
        <div class="modal-content delete-modal-content">
            <h3 class="delete-modal-title">Delete Periodical</h3>
            <p id="delete-modal-title" class="delete-modal-subtitle"></p>
            
            <div class="bg-warning rounded-lg p-15 mb-20">
                <strong>‚ö†Ô∏è Warning:</strong> This action cannot be undone.
            </div>

            <div class="bg-surface-variant rounded-lg p-15 mb-20">
                <p class="m-0 mb-10 font-bold text-primary">What would you like to do?</p>
                <div class="flex gap-10 flex-col">
                    <label class="delete-option-label">
                        <input type="radio" name="delete-option" value="db-only" checked class="radio-input">
                        <span><strong>Remove from library only</strong><br><small>Files remain on disk</small></span>
                    </label>
                    <label class="delete-option-label">
                        <input type="radio" name="delete-option" value="delete-files" class="radio-input">
                        <span><strong>Delete from library AND disk</strong><br><small>PDF and cover files will be permanently deleted</small></span>
                    </label>
                </div>
                
                <div class="mt-15 pt-15" style="border-top: 1px solid var(--border-color);">
                    <label class="flex items-center gap-10">
                        <input type="checkbox" id="delete-remove-tracking">
                        <span><strong>Also remove from tracking</strong><br><small>Stop tracking this periodical for future downloads</small></span>
                    </label>
                </div>
            </div>

            <div class="flex gap-10 justify-end">
                <button onclick="closeDeleteModal()" class="save-btn btn-cancel flex-0">Cancel</button>
                <button onclick="confirmDeletePeriodical()" class="save-btn btn-delete flex-0">Delete</button>
            </div>
        </div>
    </div>

    <!-- Manage Queue Modal -->
    <div id="manage-queue-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="downloads.closeManageQueueModal()">&times;</span>
            <div id="manage-queue-modal-content">
                <!-- Content will be dynamically populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Manage Failed Downloads Modal -->
    <div id="manage-failed-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="downloads.closeManageFailedModal()">&times;</span>
            <div id="manage-failed-modal-content">
                <!-- Content will be dynamically populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Cleanup Queue Modal -->
    <div id="cleanup-queue-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeCleanupModal()">&times;</span>
            <h2>üßπ Cleanup Download Queue</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Remove old download submissions from the queue based on status and age.
            </p>

            <div class="settings-field">
                <label for="cleanup-status">Status Filter:</label>
                <select id="cleanup-status" class="w-full">
                    <option value="">All Statuses</option>
                    <option value="completed">Completed</option>
                    <option value="failed">Failed</option>
                    <option value="skipped">Skipped</option>
                </select>
            </div>

            <div class="settings-field">
                <label for="cleanup-hours">Older than (hours):</label>
                <input type="number" id="cleanup-hours" value="24" min="1" class="w-full">
            </div>

            <div class="flex gap-10 mt-20">
                <button onclick="previewCleanup()" class="btn-secondary flex-1">Preview</button>
                <button onclick="executeCleanup()" class="save-btn flex-1">Execute Cleanup</button>
            </div>

            <div id="cleanup-preview" style="display: none; margin-top: 20px; padding: 15px; background: var(--surface-variant); border-radius: 6px;">
                <strong>Preview:</strong>
                <p id="cleanup-count" style="margin-top: 10px;"></p>
            </div>
        </div>
    </div>

    <!-- Restart Application Modal -->
    <div id="restart-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeRestartModal()">&times;</span>
            <h2>üîÑ Restart Application</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">
                Are you sure you want to restart the application? This will temporarily disconnect all users.
            </p>
            <div class="flex gap-10 justify-end">
                <button onclick="closeRestartModal()" class="save-btn btn-cancel flex-0">Cancel</button>
                <button onclick="confirmRestartApplication()" class="save-btn btn-danger flex-0">Restart</button>
            </div>
        </div>
    </div>

    <footer style="max-width: 1280px; margin: 0 auto; padding: 6px 24px; color: var(--text-secondary); border-top: 1px solid var(--border); text-align: center;">
        <p>
            <svg style="width: 16px; height: 16px; vertical-align: middle; display: inline-block; margin-right: 4px;" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            <a href="https://github.com/chadleeshaw/curator" target="_blank" style="color: var(--accent); text-decoration: none; margin-right: 16px;">GitHub</a>
            <svg style="width: 16px; height: 16px; vertical-align: middle; display: inline-block; margin-right: 4px;" viewBox="0 0 32 32" fill="currentColor">
                <path d="M16 0c-8.823 0-16 7.177-16 16s7.177 16 16 16c8.823 0 16-7.177 16-16s-7.177-16-16-16zM16 1.527c7.995 0 14.473 6.479 14.473 14.473s-6.479 14.473-14.473 14.473c-7.995 0-14.473-6.479-14.473-14.473s6.479-14.473 14.473-14.473zM11.161 7.823c-0.188-0.005-0.375 0-0.568 0.005-1.307 0.079-2.093 0.693-2.312 1.964-0.151 0.891-0.125 1.796-0.188 2.692-0.020 0.464-0.067 0.928-0.156 1.38-0.177 0.813-0.525 1.068-1.353 1.109-0.111 0.011-0.22 0.032-0.324 0.057v1.948c1.5 0.073 1.704 0.605 1.823 2.172 0.048 0.573-0.015 1.147 0.021 1.719 0.027 0.543 0.099 1.079 0.208 1.6 0.344 1.432 1.745 1.911 3.433 1.624v-1.713c-0.272 0-0.511 0.005-0.74 0-0.579-0.016-0.792-0.161-0.844-0.713-0.079-0.713-0.057-1.437-0.099-2.156-0.089-1.339-0.235-2.651-1.541-3.5 0.672-0.495 1.161-1.084 1.312-1.865 0.109-0.547 0.177-1.099 0.219-1.651s-0.025-1.12 0.021-1.667c0.077-0.885 0.135-1.249 1.197-1.213 0.161 0 0.317-0.021 0.495-0.036v-1.745c-0.213 0-0.411-0.005-0.604-0.011zM21.287 7.839c-0.365-0.011-0.729 0.016-1.089 0.079v1.697c0.329 0 0.584 0 0.833 0.005 0.439 0.005 0.772 0.177 0.813 0.661 0.041 0.443 0.041 0.891 0.083 1.339 0.089 0.896 0.136 1.796 0.292 2.677 0.136 0.724 0.636 1.265 1.255 1.713-1.088 0.729-1.411 1.776-1.463 2.953-0.032 0.801-0.052 1.615-0.093 2.427-0.037 0.74-0.297 0.979-1.043 0.995-0.208 0.011-0.411 0.027-0.64 0.041v1.74c0.432 0 0.833 0.027 1.235 0 1.239-0.073 1.995-0.677 2.239-1.885 0.104-0.661 0.167-1.333 0.183-2.005 0.041-0.615 0.036-1.235 0.099-1.844 0.093-0.953 0.532-1.349 1.484-1.411 0.089-0.011 0.177-0.032 0.267-0.057v-1.953c-0.161-0.021-0.271-0.037-0.391-0.041-0.713-0.032-1.068-0.272-1.251-0.948-0.109-0.433-0.177-0.876-0.197-1.324-0.052-0.823-0.047-1.656-0.099-2.479-0.109-1.588-1.063-2.339-2.516-2.38zM12.099 14.875c-1.432 0-1.536 2.109-0.115 2.245h0.079c0.609 0.036 1.131-0.427 1.167-1.037v-0.061c0.011-0.62-0.484-1.136-1.104-1.147zM15.979 14.875c-0.593-0.020-1.093 0.448-1.115 1.043 0 0.036 0 0.067 0.005 0.104 0 0.672 0.459 1.099 1.147 1.099 0.677 0 1.104-0.443 1.104-1.136-0.005-0.672-0.459-1.115-1.141-1.109zM19.927 14.875c-0.624-0.011-1.145 0.485-1.167 1.115 0 0.625 0.505 1.131 1.136 1.131h0.011c0.567 0.099 1.135-0.448 1.172-1.104 0.031-0.609-0.521-1.141-1.152-1.141z"/>
            </svg>
            <a href="/api/docs" target="_blank" style="color: var(--accent); text-decoration: none;">API Docs</a>
        </p>
    </footer>
</body>
</html>
